System.register("chunks:///_virtual/GameFlow.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"93c94d5eRJJRpZ/Ny3scNtT","GameFlow",void 0);e("GameFlow",{currentLevel:1,skipStartScreen:!1,isPaused:!1,isGameOver:!1,bgmMuted:!1,soundMuted:!1});t._RF.pop()}}}));

System.register("chunks:///_virtual/gameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameFlow.ts"],(function(e){var t,n,i,l,o,a,r,s,u,c,g,d,h,p,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,l=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,r=e.Node,s=e.AudioClip,u=e.Button,c=e.AudioSource,g=e.tween,d=e.Vec3,h=e.director,p=e.Component},function(e){m=e.GameFlow}],execute:function(){var v,f,C,y,b,B,S,w,_,k,P;o._RF.push({},"5d622wjFfFDFL0pB5mP/eSc","gameManager",void 0);var A=a.ccclass,F=a.property;e("gameManager",(v=A("gameManager"),f=F(r),C=F(r),y=F(s),b=F(s),v((w=t((S=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,i(t,"settingBtn",w,l(t)),i(t,"settingPanel",_,l(t)),i(t,"settingClickAudio",k,l(t)),i(t,"bgm",P,l(t)),t}n(t,e);var o=t.prototype;return o.start=function(){for(var e,t,n,i="level"+m.currentLevel,l=!1,o=0;o<this.node.children.length;o++){var a=this.node.children[o];/^level\d+$/.test(a.name)&&(a.active=a.name===i,a.name===i&&(l=!0))}if(!l){var r=this.node.children.find((function(e){return/^level\d+$/.test(e.name)}));r&&(r.active=!0)}var s=null!=(e=this.settingBtn)?e:this._getSettingBtn();if(s){var g=s.getComponent(u);g&&g.node.on(u.EventType.CLICK,this._onSettingBtnClick,this)}var d=null!=(t=this.settingPanel)?t:null==(n=this.node.parent)?void 0:n.getChildByName("gameSetting");if(d&&(d.active=!1),this.bgm&&!m.bgmMuted){var h,p=null!=(h=this.node.getComponent(c))?h:this.node.addComponent(c);p.clip=this.bgm,p.loop=!0,p.volume=1,p.play()}},o.onDestroy=function(){var e,t=null!=(e=this.settingBtn)?e:this._getSettingBtn();if(t){var n=t.getComponent(u);n&&n.node.off(u.EventType.CLICK,this._onSettingBtnClick,this)}},o._getSettingBtn=function(){var e,t=this.node.getChildByName("level1");return null!=(e=null==t?void 0:t.getChildByName("settingBtn"))?e:null},o._onSettingBtnClick=function(){var e,t;if(!m.isGameOver){var n=null!=(e=this.settingPanel)?e:null==(t=this.node.parent)?void 0:t.getChildByName("gameSetting");if(!n||!n.active){var i;if(this.settingClickAudio&&!m.soundMuted)(null!=(i=this.node.getComponent(c))?i:this.node.addComponent(c)).playOneShot(this.settingClickAudio,1);n&&(n.active=!0,n.setScale(1,1,1),g(n).to(.15,{scale:new d(1.15,1.15,1)},{easing:"quadOut"}).to(.2,{scale:new d(1,1,1)},{easing:"backOut"}).start(),h.getScheduler().setTimeScale(0),m.isPaused=!0)}}},t}(p)).prototype,"settingBtn",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(S.prototype,"settingPanel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(S.prototype,"settingClickAudio",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(S.prototype,"bgm",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=S))||B));o._RF.pop()}}}));

System.register("chunks:///_virtual/gameOver.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameFlow.ts"],(function(e){var t,n,i,r,a,o,s,l,c,u,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.Node,l=e.Button,c=e.director,u=e.Component},function(e){v=e.GameFlow}],execute:function(){var h,p,f,d,m,g,C,y,B,L,b,x;a._RF.push({},"a651c2GQhhD6LpKvt472dXX","gameOver",void 0);var T=o.ccclass,N=o.property,_=e("RESTART_LEVEL","RESTART_LEVEL");e("gameOver",(h=T("gameOver"),p=N(s),f=N(s),d=N(s),m=N(s),h((y=t((C=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"restartBtn",y,r(t)),i(t,"nextLevelBtn",B,r(t)),i(t,"successTips",L,r(t)),i(t,"failTips",b,r(t)),i(t,"nextSceneName",x,r(t)),t}n(t,e);var a=t.prototype;return a.start=function(){this.node.active=!1;var e=this.restartBtn||this.node.getChildByName("restartBtn"),t=this.nextLevelBtn||this.node.getChildByName("nextLevelBtn");if(e){var n=e.getComponent(l);n&&n.node.on(l.EventType.CLICK,this._onRestartClick,this)}if(t){var i=t.getComponent(l);i&&i.node.on(l.EventType.CLICK,this._onNextLevelClick,this)}},a.onDestroy=function(){var e=this.restartBtn||this.node.getChildByName("restartBtn"),t=this.nextLevelBtn||this.node.getChildByName("nextLevelBtn");if(e){var n=e.getComponent(l);n&&n.node.off(l.EventType.CLICK,this._onRestartClick,this)}if(t){var i=t.getComponent(l);i&&i.node.off(l.EventType.CLICK,this._onNextLevelClick,this)}},a.show=function(e){this.node.active=!0;var t=this.restartBtn||this.node.getChildByName("restartBtn"),n=this.nextLevelBtn||this.node.getChildByName("nextLevelBtn");t&&(t.active="restart"===e),n&&(n.active="next"===e);var i=this.successTips||this.node.getChildByName("succes_tips"),r=this.failTips||this.node.getChildByName("fail_tips");i&&(i.active="next"===e),r&&(r.active="restart"===e)},a._onRestartClick=function(){var e;this.node.active=!1,v.isGameOver=!1,null==(e=c.getScene())||e.emit(_)},a._onNextLevelClick=function(){var e;this.node.active=!1,v.isGameOver=!1,null==(e=c.getScene())||e.emit(_)},t}(u)).prototype,"restartBtn",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(C.prototype,"nextLevelBtn",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(C.prototype,"successTips",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(C.prototype,"failTips",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(C.prototype,"nextSceneName",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"main"}}),g=C))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/gameSetting.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameFlow.ts"],(function(t){var e,n,o,i,s,u,d,a,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,i=t.Button,s=t.Label,u=t.AudioSource,d=t.director,a=t.Component},function(t){c=t.GameFlow}],execute:function(){var r;n._RF.push({},"e4f527Yd1tB6b9rqroTXpnw","gameSetting",void 0);var l=o.ccclass;t("gameSetting",l("gameSetting")(r=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var o=n.prototype;return o.start=function(){this.node.active=!1;var t=this.node.getChildByName("closeBtn");if(t){var e=t.getComponent(i);e&&e.node.on(i.EventType.CLICK,this._onClose,this)}var n=this.node.getChildByName("musicBtn");if(n){var o=n.getComponent(i);o&&o.node.on(i.EventType.CLICK,this._onMusicBtnClick,this)}var s=this.node.getChildByName("soundBtn");if(s){var u=s.getComponent(i);u&&u.node.on(i.EventType.CLICK,this._onSoundBtnClick,this)}},o.onDestroy=function(){var t=this.node.getChildByName("closeBtn");if(t){var e=t.getComponent(i);e&&e.node.off(i.EventType.CLICK,this._onClose,this)}var n=this.node.getChildByName("musicBtn");if(n){var o=n.getComponent(i);o&&o.node.off(i.EventType.CLICK,this._onMusicBtnClick,this)}var s=this.node.getChildByName("soundBtn");if(s){var u=s.getComponent(i);u&&u.node.off(i.EventType.CLICK,this._onSoundBtnClick,this)}},o.onEnable=function(){this._updateMusicText(),this._updateSoundText()},o._updateMusicText=function(){var t=this.node.getChildByName("music_text"),e=null==t?void 0:t.getComponent(s);e&&(e.string=c.bgmMuted?"背景音乐：关":"背景音乐：开")},o._updateSoundText=function(){var t=this.node.getChildByName("sound_text"),e=null==t?void 0:t.getComponent(s);e&&(e.string=c.soundMuted?"游戏音效：关":"游戏音效：开")},o._onSoundBtnClick=function(){c.soundMuted=!c.soundMuted,this._updateSoundText()},o._onMusicBtnClick=function(){var t,e=null==(t=this.node.parent)?void 0:t.getChildByName("gameManager"),n=null==e?void 0:e.getComponent(u);c.bgmMuted=!c.bgmMuted,n&&(c.bgmMuted?n.stop():n.play()),this._updateMusicText()},o._onClose=function(){this.node.active=!1,d.getScheduler().setTimeScale(1),c.isPaused=!1},n}(a))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/gameStartUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameFlow.ts"],(function(t){var n,e,i,o,a,r,s,l,u,c,d,h;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,s=t.Node,l=t.AudioClip,u=t.AudioSource,c=t.Button,d=t.Component},function(t){h=t.GameFlow}],execute:function(){var p,m,C,g,f,v,y,B,S,k,_,b,A,w,I;a._RF.push({},"ea20d+N1qNP+5D5cGbx1xRV","gameStartUI",void 0);var z=r.ccclass,N=r.property;t("gameStartUI",(p=z("gameStartUI"),m=N(s),C=N(l),g=N(l),f=N(s),v=N(s),y=N(l),p((k=n((S=function(t){function n(){for(var n,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return n=t.call.apply(t,[this].concat(a))||this,i(n,"startBtn",k,o(n)),i(n,"startScreenSound",_,o(n)),i(n,"startAudio",b,o(n)),i(n,"gameContent",A,o(n)),i(n,"rankBtn",w,o(n)),i(n,"rankBtnAudio",I,o(n)),n._gameContent=null,n}e(n,t);var a=n.prototype;return a.start=function(){var t;if(this._gameContent=this.gameContent||(null==(t=this.node.parent)?void 0:t.getChildByName("gameManager"))||null,this._gameContent&&(this._gameContent.active=!1),h.skipStartScreen)return h.skipStartScreen=!1,this.node.active=!1,void(this._gameContent&&(this._gameContent.active=!0));this.startScreenSound&&!h.soundMuted&&(this.node.getComponent(u)||this.node.addComponent(u)).playOneShot(this.startScreenSound,1);var n=this.startBtn||this.node.getChildByName("startBtn");if(n){var e=n.getComponent(c);e&&e.node.on(c.EventType.CLICK,this._onStartClick,this)}var i=this.rankBtn||this.node.getChildByName("rankBtn");if(i){var o=i.getComponent(c);o&&o.node.on(c.EventType.CLICK,this._onRankBtnClick,this)}},a.onDestroy=function(){var t=this.startBtn||this.node.getChildByName("startBtn");if(t){var n=t.getComponent(c);n&&n.node.off(c.EventType.CLICK,this._onStartClick,this)}var e=this.rankBtn||this.node.getChildByName("rankBtn");if(e){var i=e.getComponent(c);i&&i.node.off(c.EventType.CLICK,this._onRankBtnClick,this)}},a._onRankBtnClick=function(){this.rankBtnAudio&&!h.soundMuted&&(this.node.getComponent(u)||this.node.addComponent(u)).playOneShot(this.rankBtnAudio,1)},a._onStartClick=function(){if(this.startAudio&&!h.soundMuted){var t,n,e;(this.node.getComponent(u)||this.node.addComponent(u)).playOneShot(this.startAudio,1);var i=null!=(t=null==(n=(e=this.startAudio).getDuration)?void 0:n.call(e))?t:0;this.scheduleOnce(this._enterGame,Math.max(0,i))}else this._enterGame()},a._enterGame=function(){this.node.active=!1,this._gameContent&&(this._gameContent.active=!0)},n}(d)).prototype,"startBtn",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=n(S.prototype,"startScreenSound",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=n(S.prototype,"startAudio",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(S.prototype,"gameContent",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=n(S.prototype,"rankBtn",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(S.prototype,"rankBtnAudio",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=S))||B));a._RF.pop()}}}));

System.register("chunks:///_virtual/level1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameFlow.ts","./gameOver.ts"],(function(e){var t,i,s,o,r,n,a,h,l,b,u,p,_,m,d,f,y,c,g,v,F,D,P,T,x,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,n=e._decorator,a=e.Node,h=e.SpriteFrame,l=e.Vec2,b=e.AudioClip,u=e.Vec3,p=e.UITransform,_=e.Sprite,m=e.Graphics,d=e.Color,f=e.ProgressBar,y=e.Label,c=e.input,g=e.Input,v=e.KeyCode,F=e.view,D=e.AudioSource,P=e.Component},function(e){T=e.GameFlow},function(e){x=e.RESTART_LEVEL,w=e.gameOver}],execute:function(){var N,C,S,A,B,H,I,O,R,z,M,E,L,K,V,G,U,W,k,Y,q,j,J,Q,X,Z,$,ee,te,ie,se,oe,re,ne,ae,he,le,be,ue,pe,_e,me,de,fe,ye,ce,ge,ve,Fe,De,Pe,Te,xe,we,Ne,Ce,Se,Ae,Be,He,Ie,Oe,Re,ze;r._RF.push({},"4d73eiPOTdFs5lW/q8VSoiW","level1",void 0);var Me=n.ccclass,Ee=n.property;e("level1",(N=Me("level1"),C=Ee(a),S=Ee(a),A=Ee(h),B=Ee(h),H=Ee(h),I=Ee(h),O=Ee(l),R=Ee(l),z=Ee(h),M=Ee(b),E=Ee(b),L=Ee(b),K=Ee(b),V=Ee(a),G=Ee([a]),U=Ee([Number]),W=Ee(h),k=Ee(a),Y=Ee(a),q=Ee(a),j=Ee([h]),J=Ee([h]),Q=Ee(a),N(($=t((Z=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return t=e.call.apply(e,[this].concat(r))||this,s(t,"player",$,o(t)),s(t,"boss",ee,o(t)),s(t,"enemy3_n1",te,o(t)),s(t,"enemy3_n2",ie,o(t)),s(t,"bossFrameInterval",se,o(t)),s(t,"me1",oe,o(t)),s(t,"me2",re,o(t)),s(t,"frameInterval",ne,o(t)),s(t,"pos1",ae,o(t)),s(t,"pos2",he,o(t)),s(t,"moveSpeed",le,o(t)),s(t,"bulletFrame",be,o(t)),s(t,"fireInterval",ue,o(t)),s(t,"fireAudio",pe,o(t)),s(t,"hitBossAudio",_e,o(t)),s(t,"deathAudio",me,o(t)),s(t,"bossDeathAudio",de,o(t)),s(t,"bulletSpeed",fe,o(t)),s(t,"bulletPos",ye,o(t)),s(t,"headOffset",ce,o(t)),s(t,"hitRadius",ge,o(t)),s(t,"bossHitboxes",ve,o(t)),s(t,"hitboxTags",Fe,o(t)),s(t,"bossHitFlashDuration",De,o(t)),s(t,"bossRotateInterval",Pe,o(t)),s(t,"bossRotateDuration",Te,o(t)),s(t,"bossBulletFrame",xe,o(t)),s(t,"bossBulletSpeed",we,o(t)),s(t,"bossBulletPos",Ne,o(t)),s(t,"playerHitRadius",Ce,o(t)),s(t,"hpProgressBar",Se,o(t)),s(t,"bossMaxHP",Ae,o(t)),s(t,"bossDamagePerHit",Be,o(t)),s(t,"hpText",He,o(t)),s(t,"playerDeathFrames",Ie,o(t)),s(t,"deathFrameInterval",Oe,o(t)),s(t,"bossDeathFrames",Re,o(t)),s(t,"gameOverNode",ze,o(t)),t._sprite=null,t._playerNode=null,t._bossNode=null,t._bossSprite=null,t._bossOriginalColor=null,t._bossInitialPos=new u,t._bossInitialAngle=0,t._bossHitFlashTimer=0,t._bossRotateTimer=0,t._bossRotating=!1,t._bossRotateProgress=0,t._bossRotateStartAngle=0,t._timer=0,t._t=.5,t._moveDir=0,t._fireTimer=0,t._bullets=[],t._bossBullets=[],t._bossCurrentHP=100,t._hpProgressBar=null,t._hpLabel=null,t._bossAnimTimer=0,t._playerDead=!1,t._deathFrameIndex=0,t._deathAnimTimer=0,t._deathAnimFinished=!1,t._deathLastFrameTimer=0,t._gameOver=!1,t._gameOverShown=!1,t._bossDead=!1,t._bossDeathFrameIndex=0,t._bossDeathAnimTimer=0,t._bossDeathAnimFinished=!1,t._bossDeathLastFrameTimer=0,t}i(t,e);var r=t.prototype;return r._pointOnLine=function(e){var t=this.pos1.x+(this.pos2.x-this.pos1.x)*e,i=this.pos1.y+(this.pos2.y-this.pos1.y)*e;return new l(t,i)},r._isPointInHitbox=function(e,t,i){var s=i.getComponent(p);if(!s)return!1;var o=new u;i.getWorldPosition(o);var r=this.node.getComponent(p),n=r?r.convertToNodeSpaceAR(o):o,a=s.contentSize.width,h=s.contentSize.height,l=s.anchorPoint?s.anchorPoint.x:.5,b=s.anchorPoint?s.anchorPoint.y:.5,_=n.x-a*l,m=n.x+a*(1-l),d=n.y-h*b,f=n.y+h*(1-b);return e>=_&&e<=m&&t>=d&&t<=f},r.start=function(){var e,t=this.player||this.node.getChildByName("player");if(t&&this.me1&&this.me2){this._playerNode=t,this._sprite=t.getComponent(_)||t.addComponent(_),this._sprite.spriteFrame=this.me1,this._timer=0,this._t=.5;var i=this._pointOnLine(this._t);t.setPosition(i.x,i.y,0);var s=this.node.getChildByName("Graphics");if(s){var o=s.getComponent(m)||s.addComponent(m);o.clear(),o.lineWidth=5,o.strokeColor=new d(255,255,255,255),o.moveTo(this.pos1.x,this.pos1.y),o.lineTo(this.pos2.x,this.pos2.y),o.stroke()}this._bossNode=this.boss||this.node.getChildByName("p2"),this._bossNode&&(this._bossInitialPos.set(this._bossNode.position),this._bossInitialAngle=this._bossNode.eulerAngles.z,this._bossSprite=this._bossNode.getComponent(_)||this._bossNode.getComponentInChildren(_),!this._bossSprite&&this.enemy3_n1&&(this._bossSprite=this._bossNode.addComponent(_)),this._bossSprite&&(this._bossOriginalColor=this._bossSprite.color.clone(),this.enemy3_n1&&(this._bossSprite.spriteFrame=this.enemy3_n1)));var r=this.hpProgressBar||this.node.getChildByName("HP_ProgressBar");r&&(this._hpProgressBar=r.getComponent(f)||r.getComponentInChildren(f),this._bossCurrentHP=this.bossMaxHP,this._hpProgressBar&&(this._hpProgressBar.progress=1));var n=this.hpText||this.node.getChildByName("HP_text");n&&(this._hpLabel=n.getComponent(y)||n.getComponentInChildren(y),this._updateHPText()),c.on(g.EventType.KEY_DOWN,this._onKeyDown,this),c.on(g.EventType.KEY_UP,this._onKeyUp,this),c.on(g.EventType.TOUCH_START,this._onTouchStart,this),null==(e=this.node.scene)||e.on(x,this.restart,this)}},r.onDestroy=function(){var e;c.off(g.EventType.KEY_DOWN,this._onKeyDown,this),c.off(g.EventType.KEY_UP,this._onKeyUp,this),c.off(g.EventType.TOUCH_START,this._onTouchStart,this),null==(e=this.node.scene)||e.off(x,this.restart,this)},r._onKeyDown=function(e){e.keyCode===v.KEY_A&&(this._moveDir=-1),e.keyCode===v.KEY_D&&(this._moveDir=1)},r._onKeyUp=function(e){},r._onTouchStart=function(e){var t=e.getLocation(),i=.5*F.getVisibleSizeInPixel().width;t.x<i?this._moveDir=-1:t.x>i&&(this._moveDir=1)},r._spawnBullet=function(){if(this._playerNode&&this._bossNode&&this.bulletFrame){if(this.fireAudio&&!T.soundMuted)(this.node.getComponent(D)||this.node.addComponent(D)).playOneShot(this.fireAudio,.12);var e,t,i=this._bossNode.position.x,s=this._bossNode.position.y,o=this._playerNode.eulerAngles.z,r=this.bulletPos||this.node.getChildByName("bulletPos");if(r&&r.isValid){var n=new u;r.getWorldPosition(n);var h=this.node.getComponent(p),l=h?h.convertToNodeSpaceAR(n):n;e=l.x,t=l.y}else{var b=this._playerNode.position.x,m=this._playerNode.position.y,f=o*Math.PI/180;e=b+Math.sin(f)*this.headOffset,t=m+Math.cos(f)*this.headOffset}var y=i-e,c=s-t,g=Math.sqrt(y*y+c*c)||1,v=y/g*this.bulletSpeed,F=c/g*this.bulletSpeed,P=new a("bullet");P.addComponent(p),P.setPosition(e,t,0),P.setScale(1.2,1.2,1.2),P.setRotationFromEuler(0,0,o);var x=P.addComponent(_);x.spriteFrame=this.bulletFrame,x.color=new d(255,255,255,255),this.node.addChild(P),this._bullets.push({node:P,vx:v,vy:F})}},r._damageBoss=function(){if(!this._bossDead&&(this._bossCurrentHP=Math.max(0,this._bossCurrentHP-this.bossDamagePerHit),this._hpProgressBar&&this.bossMaxHP>0&&(this._hpProgressBar.progress=this._bossCurrentHP/this.bossMaxHP),this._updateHPText(),this._bossCurrentHP<=0)){if(this.bossDeathAudio&&!T.soundMuted)(this.node.getComponent(D)||this.node.addComponent(D)).playOneShot(this.bossDeathAudio,1);this.bossDeathFrames.length>0&&this._bossSprite?(this._bossDead=!0,this._bossDeathFrameIndex=0,this._bossDeathAnimTimer=0,this._bossDeathAnimFinished=!1,this._bossDeathLastFrameTimer=0,this._bossSprite.spriteFrame=this.bossDeathFrames[0]):this._showGameOver("next")}},r._updateHPText=function(){if(this._hpLabel){var e=Math.floor(this._bossCurrentHP),t=Math.floor(this.bossMaxHP);this._hpLabel.string=e+"/"+t}},r._triggerBossHitFlash=function(){this._bossSprite&&(this._bossOriginalColor||(this._bossOriginalColor=this._bossSprite.color.clone()),this._bossSprite.color=new d(255,0,0,255),this._bossHitFlashTimer=this.bossHitFlashDuration)},r._spawnBossBullet=function(){if(this._bossNode&&this._playerNode&&this.bossBulletFrame){var e,t,i=this.bossBulletPos||this._bossNode.getChildByName("bulletPos");if(i&&i.isValid){var s=new u;i.getWorldPosition(s);var o=this.node.getComponent(p),r=o?o.convertToNodeSpaceAR(s):s;e=r.x,t=r.y}else e=this._bossNode.position.x,t=this._bossNode.position.y;var n=this._playerNode.position.x-e,h=this._playerNode.position.y-t,l=Math.sqrt(n*n+h*h)||1,b=n/l*this.bossBulletSpeed,m=h/l*this.bossBulletSpeed,d=180*Math.atan2(h,n)/Math.PI-90,f=new a("boss_bullet");f.addComponent(p),f.setPosition(e,t,0),f.setRotationFromEuler(0,0,d),f.addComponent(_).spriteFrame=this.bossBulletFrame,this.node.addChild(f),this._bossBullets.push({node:f,vx:b,vy:m})}},r._onPlayerHitByBossBullet=function(){if(!this._playerDead){if(this._playerDead=!0,this.deathAudio&&!T.soundMuted)(this.node.getComponent(D)||this.node.addComponent(D)).playOneShot(this.deathAudio,1);this._deathFrameIndex=0,this._deathAnimTimer=0,this._deathAnimFinished=!1,this._deathLastFrameTimer=0,this._sprite&&this.playerDeathFrames.length>0&&(this._sprite.spriteFrame=this.playerDeathFrames[0])}},r._showGameOver=function(e){if(!this._gameOverShown){this._gameOverShown=!0,this._gameOver=!0,T.isGameOver=!0;var t=this.gameOverNode||this.node.getChildByName("GameOverPanel"),i=null==t?void 0:t.getComponent(w);i&&i.show(e)}},r.restart=function(){if(this._gameOver=!1,this._gameOverShown=!1,this._playerDead=!1,this._deathFrameIndex=0,this._deathAnimTimer=0,this._t=.5,this._moveDir=0,this._bossCurrentHP=this.bossMaxHP,this._bossRotateTimer=0,this._bossRotating=!1,this._bossRotateProgress=0,this._bossDead=!1,this._bossDeathFrameIndex=0,this._bossDeathAnimTimer=0,this._bossDeathAnimFinished=!1,this._bossDeathLastFrameTimer=0,this._fireTimer=0,this._timer=0,this._bossAnimTimer=0,this._bossHitFlashTimer=0,this._bullets.forEach((function(e){return e.node.isValid&&e.node.destroy()})),this._bullets.length=0,this._bossBullets.forEach((function(e){return e.node.isValid&&e.node.destroy()})),this._bossBullets.length=0,this._bossNode&&(this._bossNode.active=!0,this._bossNode.setPosition(this._bossInitialPos),this._bossNode.setRotationFromEuler(0,0,this._bossInitialAngle)),this._playerNode){this._playerNode.active=!0;var e=this._pointOnLine(this._t);this._playerNode.setPosition(e.x,e.y,0),this._sprite&&this.me1&&(this._sprite.spriteFrame=this.me1)}this._deathAnimFinished=!1,this._deathLastFrameTimer=0,this._bossSprite&&this._bossOriginalColor&&(this._bossSprite.color=this._bossOriginalColor.clone()),this._bossSprite&&this.enemy3_n1&&(this._bossSprite.spriteFrame=this.enemy3_n1),this._hpProgressBar&&this.bossMaxHP>0&&(this._hpProgressBar.progress=1),this._updateHPText()},r._faceBoss=function(){if(this._playerNode&&this._bossNode){var e=this._playerNode.position.x,t=this._playerNode.position.y,i=this._bossNode.position.x,s=this._bossNode.position.y,o=180*Math.atan2(s-t,i-e)/Math.PI-90;this._playerNode.setRotationFromEuler(0,0,o)}},r.update=function(e){var t=this;if(!T.isPaused&&(this._bossDead&&(this._bossSprite&&this.bossDeathFrames.length>0?(this._bossDeathFrameIndex<this.bossDeathFrames.length-1?(this._bossDeathAnimTimer+=e,this._bossDeathAnimTimer>=this.deathFrameInterval&&(this._bossDeathAnimTimer=0,this._bossDeathFrameIndex++,this._bossSprite.spriteFrame=this.bossDeathFrames[this._bossDeathFrameIndex])):(this._bossDeathLastFrameTimer+=e,this._bossDeathLastFrameTimer>=this.deathFrameInterval&&(this._bossDeathAnimFinished=!0)),this._bossDeathAnimFinished&&!this._gameOverShown&&(this._bossNode&&(this._bossNode.active=!1),this._showGameOver("next"))):this._gameOverShown||(this._bossNode&&(this._bossNode.active=!1),this._showGameOver("next"))),this._sprite&&this.me1&&this.me2)){if(this._playerNode&&!this._playerDead){this._t+=this._moveDir*this.moveSpeed*e,this._t=Math.max(0,Math.min(1,this._t));var i=this._pointOnLine(this._t);this._playerNode.setPosition(i.x,i.y,0),this._faceBoss()}if(this._bossNode&&!this._bossDead)if(this._bossRotating){this._bossRotateProgress+=e/this.bossRotateDuration;var s=Math.min(1,this._bossRotateProgress);this._bossNode.setRotationFromEuler(0,0,this._bossRotateStartAngle+360*s),this._bossRotateProgress>=1&&(this._bossRotating=!1,this._spawnBossBullet())}else this._bossRotateTimer+=e,this._bossRotateTimer>=this.bossRotateInterval&&(this._bossRotating=!0,this._bossRotateProgress=0,this._bossRotateStartAngle=this._bossNode.eulerAngles.z,this._bossRotateTimer=0);var o=[],r=this._playerNode;this._bossBullets.forEach((function(i,s){var n=i.node;if(n.isValid){n.setPosition(n.position.x+i.vx*e,n.position.y+i.vy*e,0);var a=!1;if(r&&r.isValid&&!t._playerDead&&!t._bossDead){var h=n.position.x-r.position.x,l=n.position.y-r.position.y;h*h+l*l<t.playerHitRadius*t.playerHitRadius&&(a=!0,t._onPlayerHitByBossBullet())}!a&&(Math.abs(n.position.x)>400||Math.abs(n.position.y)>700)&&(a=!0),a&&(o.push(s),n.destroy())}else o.push(s)}));for(var n=o.length-1;n>=0;n--)this._bossBullets.splice(o[n],1);if(!this._playerDead&&!this._bossDead&&this.bulletFrame&&this._playerNode&&this._bossNode)for(this._fireTimer+=e;this._fireTimer>=this.fireInterval;)this._fireTimer-=this.fireInterval,this._spawnBullet();var a=this._bossNode,h=[],l=this.bossHitboxes,b=this.hitboxTags;this._bullets.forEach((function(i,s){var o=i.node;if(o.setPosition(o.position.x+i.vx*e,o.position.y+i.vy*e,0),a&&l.length>0)for(var r=0;r<l.length;r++){var n=l[r];if(n&&n.isValid&&t._isPointInHitbox(o.position.x,o.position.y,n)){if(h.push(s),o.destroy(),1===b[r]&&!t._bossDead&&!t._playerDead)if(t._triggerBossHitFlash(),t._damageBoss(),t.hitBossAudio&&!T.soundMuted)(t.node.getComponent(D)||t.node.addComponent(D)).playOneShot(t.hitBossAudio,1);break}}else if(a&&!t._bossDead&&!t._playerDead){var u=o.position.x-a.position.x,p=o.position.y-a.position.y;u*u+p*p<t.hitRadius*t.hitRadius&&(h.push(s),o.destroy(),t._triggerBossHitFlash())}(Math.abs(o.position.x)>400||Math.abs(o.position.y)>700)&&(h.push(s),o.destroy())}));for(var u=h.length-1;u>=0;u--)this._bullets.splice(h[u],1);this._bossHitFlashTimer>0&&(this._bossHitFlashTimer-=e,this._bossHitFlashTimer<=0&&this._bossSprite&&this._bossOriginalColor&&(this._bossSprite.color=this._bossOriginalColor.clone(),this._bossHitFlashTimer=0)),!this._bossDead&&this._bossSprite&&this.enemy3_n1&&this.enemy3_n2&&(this._bossAnimTimer+=e,this._bossAnimTimer>=this.bossFrameInterval&&(this._bossAnimTimer=0,this._bossSprite.spriteFrame=this._bossSprite.spriteFrame===this.enemy3_n1?this.enemy3_n2:this.enemy3_n1)),this._playerDead?(this._sprite&&this.playerDeathFrames.length>0?this._deathFrameIndex<this.playerDeathFrames.length-1?(this._deathAnimTimer+=e,this._deathAnimTimer>=this.deathFrameInterval&&(this._deathAnimTimer=0,this._deathFrameIndex++,this._sprite.spriteFrame=this.playerDeathFrames[this._deathFrameIndex])):(this._deathLastFrameTimer+=e,this._deathLastFrameTimer>=this.deathFrameInterval&&(this._deathAnimFinished=!0)):this._deathAnimFinished=!0,this._deathAnimFinished&&!this._gameOverShown&&(this._playerNode&&(this._playerNode.active=!1),this._showGameOver("restart"))):(this._timer+=e,this._timer>=this.frameInterval&&(this._timer=0,this._sprite.spriteFrame=this._sprite.spriteFrame===this.me1?this.me2:this.me1))}},t}(P)).prototype,"player",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(Z.prototype,"boss",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(Z.prototype,"enemy3_n1",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t(Z.prototype,"enemy3_n2",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(Z.prototype,"bossFrameInterval",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.15}}),oe=t(Z.prototype,"me1",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=t(Z.prototype,"me2",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(Z.prototype,"frameInterval",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.15}}),ae=t(Z.prototype,"pos1",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(-320,-396)}}),he=t(Z.prototype,"pos2",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(320,-396)}}),le=t(Z.prototype,"moveSpeed",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.5}}),be=t(Z.prototype,"bulletFrame",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(Z.prototype,"fireInterval",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.12}}),pe=t(Z.prototype,"fireAudio",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(Z.prototype,"hitBossAudio",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=t(Z.prototype,"deathAudio",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=t(Z.prototype,"bossDeathAudio",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=t(Z.prototype,"bulletSpeed",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),ye=t(Z.prototype,"bulletPos",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=t(Z.prototype,"headOffset",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 55}}),ge=t(Z.prototype,"hitRadius",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),ve=t(Z.prototype,"bossHitboxes",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Fe=t(Z.prototype,"hitboxTags",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[1,2,3,4,5,6,7,8]}}),De=t(Z.prototype,"bossHitFlashDuration",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.12}}),Pe=t(Z.prototype,"bossRotateInterval",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Te=t(Z.prototype,"bossRotateDuration",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),xe=t(Z.prototype,"bossBulletFrame",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=t(Z.prototype,"bossBulletSpeed",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 400}}),Ne=t(Z.prototype,"bossBulletPos",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(Z.prototype,"playerHitRadius",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 45}}),Se=t(Z.prototype,"hpProgressBar",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=t(Z.prototype,"bossMaxHP",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),Be=t(Z.prototype,"bossDamagePerHit",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),He=t(Z.prototype,"hpText",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=t(Z.prototype,"playerDeathFrames",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Oe=t(Z.prototype,"deathFrameInterval",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),Re=t(Z.prototype,"bossDeathFrames",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ze=t(Z.prototype,"gameOverNode",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=Z))||X));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./GameFlow.ts","./gameManager.ts","./gameOver.ts","./gameSetting.ts","./gameStartUI.ts","./level1.ts"],(function(){return{setters:[null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});